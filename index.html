<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RF24Gateway - TCP/IP over RF24Network: RF24Gateway</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RF24Gateway - TCP/IP over RF24Network<span id="projectnumber">&#160;v2.1.1</span>
   </div>
   <div id="projectbrief">TMRh20 - Pushing the practical limits of RF24 modules</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">RF24Gateway </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md34">News - 2023 API Changes</a></li>
<li class="level1"><a href="#autotoc_md35">Installation</a></li>
<li class="level1"><a href="#autotoc_md36">How It Works</a></li>
<li class="level1"><a href="#autotoc_md37">Simple Configuration</a></li>
<li class="level1"><a href="#autotoc_md38">Advanced Configuration</a></li>
<li class="level1"><a href="#autotoc_md39">Network Configuration Example</a><ul><li class="level2"><a href="#autotoc_md40">Explanation</a></li>
<li class="level2"><a href="#autotoc_md41">Routing Configuration</a><ul><li class="level3"><a href="#autotoc_md42">Additional Routing Configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_docs_2main__page"></a></p>
<p>RF24Gateway is a library style replacement for the standalone RF24toTUN application, used with RF24Ethernet.</p>
<p>In addition to passing TCP/IP payloads to a network interface, RF24Gateway also allows users to send and receive standard RF24Network payloads.</p>
<p>This allows users to deploy and manage hybrid networks, consisting of nodes communicating via TCP/IP and RF24Network Messages</p>
<h1><a class="anchor" id="autotoc_md34"></a>
News - 2023 API Changes</h1>
<p>Introducing <b>RF24Network, RF24Mesh &amp; RF24Gateway v2.0</b> with some <em>significant API changes</em>, adding the use of <a href="https://cplusplus.com/doc/oldtutorial/templates/">C++ Templates</a> in order to support a range of ESB enabled radios, most recently NRF52x radios.</p>
<p><b>Important Notes:</b></p><ul>
<li>Any network layer that uses v2 needs to have RF24Network/RF24Mesh dependencies of v2 or newer. RF24 v1.x is an exception here.</li>
<li>General usage should remain backward compatible, see the included examples of the related libraries for more info</li>
<li>Any third party libs that extend the network/mesh layer may also need to be updated to incorporate the new templated class prototypes: <div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> radio_t&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classESBNetwork.html">ESBNetwork</a>;</div>
<div class="line">  </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> network_t, <span class="keyword">class</span> radio_t&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classESBMesh.html">ESBMesh</a>;</div>
<div class="ttc" id="aclassESBMesh_html"><div class="ttname"><a href="classESBMesh.html">ESBMesh</a></div><div class="ttdef"><b>Definition</b> <a href="RF24Gateway_8h_source.html#l00048">RF24Gateway.h:48</a></div></div>
<div class="ttc" id="aclassESBNetwork_html"><div class="ttname"><a href="classESBNetwork.html">ESBNetwork</a></div><div class="ttdef"><b>Definition</b> <a href="RF24Gateway_8h_source.html#l00045">RF24Gateway.h:45</a></div></div>
</div><!-- fragment --></li>
<li>Third party libs should also be able to use the backward-compatible typedef in their template:<ul>
<li>ESBGateway.h: <div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> network_t, <span class="keyword">typename</span> mesh_t&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classESBGateway.html">ESBGateway</a></div>
<div class="ttc" id="aclassESBGateway_html"><div class="ttname"><a href="classESBGateway.html">ESBGateway</a></div><div class="ttdef"><b>Definition</b> <a href="RF24Gateway_8h_source.html#l00065">RF24Gateway.h:66</a></div></div>
</div><!-- fragment --> and inform the compiler what types they intend to support:</li>
<li>ESBGateway.cpp: <div class="fragment"><div class="line"><span class="keyword">template</span> <span class="keyword">class </span><a class="code hl_class" href="classESBGateway.html">ESBGateway&lt;RF24Network, RF24Mesh&gt;</a>;</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>The auto installers do not perform a version check like package managers, so having the correct versions of the software is important.</li>
<li>We <em>will</em> be maintaining the v1.x versions with bugfixes etc for those who cannot or do not wish to migrate to the newer template approach.</li>
</ul>
<h1><a class="anchor" id="autotoc_md35"></a>
Installation</h1>
<p>See <a href="http://nRF24.github.io/RF24">http://nRF24.github.io/RF24</a> for installation instructions using the installer, or clone the RF24 libs and run 'make install' for each one.</p>
<p>After running the installer, RF24Gateway will be installed at rf24libs/RF24Gateway. <a href="examples.html"><b>Examples</b></a> are included for operating the gateway as well as client scripts &amp; programs to control nodes via http requests.</p>
<p>Note: RF24Gateway is tested with and defaults to using RF24Mesh. Sensor nodes must also use RF24Mesh or be statically assigned within RF24Mesh.</p>
<p>See <a href="http://nRF24.github.io/RF24Ethernet/">http://nRF24.github.io/RF24Ethernet/</a> for related documentation for use with RF24Gateway.</p>
<h1><a class="anchor" id="autotoc_md36"></a>
How It Works</h1>
<p>RF24Gateway is relatively simple in design, and uses the <a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt">Universal TUN/TAP driver for Linux</a></p>
<p>Data incoming from the RF24 communication stack (designated as external data) is passed to the interface without modification. Conversely, incoming TCP/IP or other data received on the TUN/TAP interface is passed directly into the radio network and designated as external data.</p>
<p>Linux devices running RF24Gateway can establish network links using the built-in TCP/IP stack, and users can include Arduino/AVR devices or additional RPi devices to automatically extend the wireless range.</p>
<p>Arduino/AVR devices, etc must utilize a software IP stack such as uIP.</p>
<h1><a class="anchor" id="autotoc_md37"></a>
Simple Configuration</h1>
<p>In the standard configuration, a single Linux/RF24Gateway node is used to provide connectivity to one or more Arduino nodes running RF24Ethernet. In this case the master node could be configured with IP 10.1.3.1 netmask 255.255.255.0 and nodeID 0 The remaining Arduino nodes can used nodeIDs 2-253, and would be assigned IP addresses 10.1.3.2-253 and netmask 255.255.255.0</p>
<p>If there are problems starting the examples, the following commands can be run to configure the interface:</p>
<div class="fragment"><div class="line">ip tuntap add dev tun_nrf24 mode tun user pi multi_queue</div>
<div class="line">ifconfig tun_nrf24 10.1.3.1/24</div>
</div><!-- fragment --><p>To enable nat and routing, the following commands can also be run:</p>
<div class="fragment"><div class="line">sudo sysctl -w net.ipv4.ip_forward=1</div>
<div class="line">sudo iptables -t nat -A POSTROUTING -j MASQUERADE</div>
</div><!-- fragment --><p>See <a href="http://nRF24.github.io/RF24Ethernet/ConfigAndSetup.html">http://nRF24.github.io/RF24Ethernet/ConfigAndSetup.html</a> for more info</p>
<h1><a class="anchor" id="autotoc_md38"></a>
Advanced Configuration</h1>
<p>In a more advanced configuration, users can use two or more nodes running RF24Gateway together, along with Arduino Nodes running RF24Ethernet In this case the master node could be configured differently with IP 10.1.3.1 netmask 255.255.0.0 and nodeID 0 The child RPi2 node could be assigned IP 10.1.3.33 netmask 255.255.0.0 and nodeID 33 Another device, lets say usb0 connected to the child RPi2 node is assigned IP 10.1.5.1 netmask 255.255.255.0</p>
<p>In this configuration, connectivity between all nodes in the mesh would be established, but a routing table is needed to include attached and internet devices.</p>
<p>To fully enable routing beyond the RPi devices, a routing table needs to be added to the Master node:</p>
<ol type="1">
<li>Rename the file RF24Gateway/examples/routing.txx to routing.txt</li>
<li>Edit the file accordingly</li>
<li>Restart the gateway example to reload routing info</li>
</ol>
<h1><a class="anchor" id="autotoc_md39"></a>
Network Configuration Example</h1>
<p>Local WiFi/Ethernet Network (Windows,Linux,RPi devices etc) - 10.10.1.0 - 255.255.255.0 ( 10.10.1.x network ) <br  />
 RPi devices (tun_nrf24 interfaces &amp; all connected devices) - 10.1.0.0 - 255.255.0.0 ( 10.1.x.x network )</p>
<h2><a class="anchor" id="autotoc_md40"></a>
Explanation</h2>
<p>The RF24Gateway/RF24Mesh network supports about 253 hosts. I setup the RF24Gateway and all associated devices with a much larger subnet in this config to encompass all devices directly accessible via the RF24Gateway network.</p>
<p>ie: RPi master 10.1.3.1/16, RPi2 child 10.1.3.33/16, RPi2 child usb0 10.1.5.1/24</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Routing Configuration</h2>
<p>In the RF24Gateway example working directory, create a file "routing.txt". Add routing entries in a standard kind of format:</p>
<div class="fragment"><div class="line">IP&lt;space&gt;NetMask&lt;space&gt;Gateway</div>
</div><!-- fragment --><p>Example routing.txt file:</p>
<ul>
<li><p class="startli">Traffic for 10.1.5.x will use 10.1.3.33 as the gateway</p>
<div class="fragment"><div class="line">10.1.5.0 255.255.255.0 10.1.3.33</div>
</div><!-- fragment --></li>
<li><p class="startli">Traffic for 10.1.4.x will use 10.1.3.34 as the gateway</p>
<div class="fragment"><div class="line">10.1.4.0 255.255.255.0 10.1.3.34</div>
</div><!-- fragment --></li>
<li><p class="startli">Traffic not in the RF24Gateway network will be sent via 10.10.3.33 by default</p>
<div class="fragment"><div class="line">0.0.0.0 0.0.0.0 10.10.3.33</div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="autotoc_md42"></a>
Additional Routing Configuration</h3>
<p>You can specify any combination of IP/Netmask in the routing.txt file to create unique subnets for routing traffic.</p>
<p>Examples are:</p>
<ul>
<li><p class="startli">Traffic for 10.1.5.(1-30) will use 10.1.3.33 as the gateway</p>
<div class="fragment"><div class="line">10.1.5.0 255.255.255.224 10.1.3.33</div>
</div><!-- fragment --></li>
<li><p class="startli">Traffic for 10.1.5.(33-62) will use 10.1.3.34 as the gateway</p>
<div class="fragment"><div class="line">10.1.5.32 255.255.255.224 10.1.3.34</div>
</div><!-- fragment --></li>
<li><p class="startli">Traffic for 10.1.5.(65-94) will use 10.1.3.35 as the gateway</p>
<div class="fragment"><div class="line">10.1.5.64 255.255.255.224 10.1.3.35</div>
</div><!-- fragment --></li>
<li><p class="startli">Traffic not in the RF24Gateway network will be sent via 10.10.3.32 by default</p>
<div class="fragment"><div class="line">0.0.0.0 0.0.0.0 10.10.3.32</div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Oct 6 2024 for RF24Gateway - TCP/IP over RF24Network by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
