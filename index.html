<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RF24Gateway - TCP/IP over RF24Network: RF24Gateway</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RF24Gateway - TCP/IP over RF24Network
   &#160;<span id="projectnumber">v1.0.2</span>
   </div>
   <div id="projectbrief">TMRh20 - Pushing the practical limits of RF24 modules</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="classRF24Gateway.html">RF24Gateway</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_main_page"></a><a class="el" href="classRF24Gateway.html">RF24Gateway</a> is a library style replacement for the standalone RF24toTUN application, used with RF24Ethernet.</p>
<p>In addition to passing TCP/IP payloads to a network interface, <a class="el" href="classRF24Gateway.html">RF24Gateway</a> also allows users to send and receive standard RF24Network payloads.</p>
<p>This allows users to deploy and manage hybrid networks, consisting of nodes communicating via TCP/IP and RF24Network Messages</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Installation</h1>
<p>See <a href="http://nRF24.github.io/RF24">http://nRF24.github.io/RF24</a> for installation instructions using the installer, or clone the RF24 libs and run 'make install' for each one.</p>
<p>After running the installer, <a class="el" href="classRF24Gateway.html">RF24Gateway</a> will be installed at rf24libs/RF24Gateway. <a href="examples.html"><b>Examples</b></a> are included for operating the gateway as well as client scripts &amp; programs to control nodes via http requests.</p>
<p>Note: <a class="el" href="classRF24Gateway.html">RF24Gateway</a> is tested with and defaults to using RF24Mesh. Sensor nodes must also use RF24Mesh or be statically assigned within RF24Mesh.</p>
<p>See <a href="http://nRF24.github.io/RF24Ethernet/">http://nRF24.github.io/RF24Ethernet/</a> for related documentation for use with <a class="el" href="classRF24Gateway.html">RF24Gateway</a>.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
How It Works</h1>
<p><a class="el" href="classRF24Gateway.html">RF24Gateway</a> is relatively simple in design, and uses the <a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt">Universal TUN/TAP driver for Linux</a></p>
<p>Data incoming from the RF24 communication stack (designated as external data) is passed to the interface without modification. Conversely, incoming TCP/IP or other data received on the TUN/TAP interface is passed directly into the radio network and designated as external data.</p>
<p>Linux devices running <a class="el" href="classRF24Gateway.html">RF24Gateway</a> can establish network links using the built-in TCP/IP stack, and users can include Arduino/AVR devices or additional RPi devices to automatically extend the wireless range.<br  />
 Arduino/AVR devices, etc must utilize a software IP stack such as uIP.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Simple Configuration</h1>
<p>In the standard configuration, a single Linux/RF24Gateway node is used to provide connectivity to one or more Arduino nodes running RF24Ethernet. In this case the master node could be configured with IP 10.1.3.1 netmask 255.255.255.0 and nodeID 0 The remaining Arduino nodes can used nodeIDs 2-253, and would be assigned IP addresses 10.1.3.2-253 and netmask 255.255.255.0</p>
<p>If there are problems starting the examples, the following commands can be run to configure the interface:</p>
<div class="fragment"><div class="line">ip tuntap add dev tun_nrf24 mode tun user pi multi_queue</div>
<div class="line">ifconfig tun_nrf24 10.1.3.1/24</div>
</div><!-- fragment --><p>To enable nat and routing, the following commands can also be run:</p>
<div class="fragment"><div class="line">sudo sysctl -w net.ipv4.ip_forward=1</div>
<div class="line">sudo iptables -t nat -A POSTROUTING -j MASQUERADE</div>
</div><!-- fragment --><p>See <a href="http://nRF24.github.io/RF24Ethernet/ConfigAndSetup.html">http://nRF24.github.io/RF24Ethernet/ConfigAndSetup.html</a> for more info</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Advanced Configuration</h1>
<p>In a more advanced configuration, users can use two or more nodes running <a class="el" href="classRF24Gateway.html">RF24Gateway</a> together, along with Arduino Nodes running RF24Ethernet In this case the master node could be configured differently with IP 10.1.3.1 netmask 255.255.0.0 and nodeID 0 The child RPi2 node could be assigned IP 10.1.3.33 netmask 255.255.0.0 and nodeID 33 Another device, lets say usb0 connected to the child RPi2 node is assigned IP 10.1.5.1 netmask 255.255.255.0</p>
<p>In this configuration, connectivity between all nodes in the mesh would be established, but a routing table is needed to include attached and internet devices.</p>
<p>To fully enable routing beyond the RPi devices, a routing table needs to be added to the Master node:</p><ol type="1">
<li>Rename the file RF24Gateway/examples/routing.txx to routing.txt</li>
<li>Edit the file accordingly</li>
<li>Restart the gateway example to reload routing info</li>
</ol>
<h1><a class="anchor" id="autotoc_md5"></a>
Network Configuration Example</h1>
<p>Local WiFi/Ethernet Network (Windows,Linux,RPi devices etc) - 10.10.1.0 - 255.255.255.0 ( 10.10.1.x network ) <br  />
 RPi devices (tun_nrf24 interfaces &amp; all connected devices) - 10.1.0.0 - 255.255.0.0 ( 10.1.x.x network )</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Explanation</h2>
<p>The RF24Gateway/RF24Mesh network supports about 253 hosts. I setup the <a class="el" href="classRF24Gateway.html">RF24Gateway</a> and all associated devices with a much larger subnet in this config to encompass all devices directly accessible via the <a class="el" href="classRF24Gateway.html">RF24Gateway</a> network.</p>
<p>ie: RPi master 10.1.3.1/16, RPi2 child 10.1.3.33/16, RPi2 child usb0 10.1.5.1/24</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Routing Configuration</h2>
<p>In the <a class="el" href="classRF24Gateway.html">RF24Gateway</a> example working directory, create a file "routing.txt" <br  />
 Add routing entries in a standard kind of format: </p><div class="fragment"><div class="line">IP&lt;space&gt;NetMask&lt;space&gt;Gateway</div>
</div><!-- fragment --><p> Example routing.txt file:</p>
<ul>
<li>Traffic for 10.1.5.x will use 10.1.3.33 as the gateway <div class="fragment"><div class="line">10.1.5.0 255.255.255.0 10.1.3.33</div>
</div><!-- fragment --></li>
<li>Traffic for 10.1.4.x will use 10.1.3.34 as the gateway <div class="fragment"><div class="line">10.1.4.0 255.255.255.0 10.1.3.34</div>
</div><!-- fragment --></li>
<li>Traffic not in the <a class="el" href="classRF24Gateway.html">RF24Gateway</a> network will be sent via 10.10.3.33 by default <div class="fragment"><div class="line">0.0.0.0 0.0.0.0 10.10.3.33</div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Additional Routing Configuration</h3>
<p>You can specify any combination of IP/Netmask in the routing.txt file to create unique subnets for routing traffic.</p>
<p>Examples are:</p>
<ul>
<li>Traffic for 10.1.5.(1-30) will use 10.1.3.33 as the gateway <div class="fragment"><div class="line">10.1.5.0 255.255.255.224 10.1.3.33</div>
</div><!-- fragment --></li>
<li>Traffic for 10.1.5.(33-62) will use 10.1.3.34 as the gateway <div class="fragment"><div class="line">10.1.5.32 255.255.255.224 10.1.3.34</div>
</div><!-- fragment --></li>
<li>Traffic for 10.1.5.(65-94) will use 10.1.3.35 as the gateway <div class="fragment"><div class="line">10.1.5.64 255.255.255.224 10.1.3.35</div>
</div><!-- fragment --></li>
<li>Traffic not in the <a class="el" href="classRF24Gateway.html">RF24Gateway</a> network will be sent via 10.10.3.32 by default <div class="fragment"><div class="line">0.0.0.0 0.0.0.0 10.10.3.32</div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 13 2021 01:13:07 for RF24Gateway - TCP/IP over RF24Network by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
